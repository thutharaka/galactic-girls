<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Star Quest Tasks</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500&family=Orbitron:wght@500&display=swap" rel="stylesheet">

<link rel="stylesheet" href="styles1.css">
<style>
/* Floating star default style */
.star {
    position: absolute;
    border-radius: 50%;
    background: #f5d5e0;
    opacity: 0.5;
    transition: all 0.5s ease;
}

/* Glow for category task stars */
.star.glow {
    box-shadow: 0 0 8px #f5d5e0, 0 0 16px #c874b2, 0 0 24px #f5d5e0;
    transform: scale(1.5);
    opacity: 1 !important;
}

/* Continuous twinkle for floating stars */
@keyframes twinkle {
    0%, 100% { opacity: 0.3; transform: scale(0.8);}
    50% { opacity: 1; transform: scale(1);}
}
</style>
</head>
<body>

<!-- Navigation -->
<nav class="nav-buttons">
    <a href="index.html" class="nav-button">Home</a>
    <a href="tasks.html" class="nav-button active">To-Do</a>
    <a href="starmap.html" class="nav-button">Star Map</a>
    <a href="teampage.html" class="nav-button">About Us</a>
</nav>

<div class="container">

    <!-- Main User Tasks -->
    <div class="card">
        <h1>STAR QUEST</h1>
        <form class="input-form" id="todoForm">
            <input type="text" id="todoInput" placeholder="Enter mission objective..." autocomplete="off">
            <button class="add-btn">LAUNCH</button>
        </form>

        <div class="stats">
            <span id="activeCount"></span>
            <span id="completedCount"></span>
        </div>

        <div id="emptyState" class="empty-state">No missions assigned ðŸš€</div>
        <div id="todoList" class="todo-list"></div>
    </div>

    <!-- Category Tasks -->
    <div class="category-card">
        <div class="category-title">Colonizing Space</div>
        <div class="category-list">
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-1">
                Research & Development
                <span class="star" id="star-cat-1"></span>
            </div>
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-2">
                Mission Planning & Logistics
                <span class="star" id="star-cat-2"></span>
            </div>
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-3">
                Transportation Systems Development
                <span class="star" id="star-cat-3"></span>
            </div>
        </div>

        <div class="category-title">Immersive Worlds</div>
        <div class="category-list">
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-4">
                3D Modeling and Asset Creation
                <span class="star" id="star-cat-4"></span>
            </div>
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-5">
                Audio and Sound Design
                <span class="star" id="star-cat-5"></span>
            </div>
            <div class="todo-item">
                <input type="checkbox" class="category-checkbox" data-star="star-cat-6">
                Programming Logic and Interactivity
                <span class="star" id="star-cat-6"></span>
            </div>
        </div>
    </div>

</div>

<!-- Floating stars in background -->
<div id="starContainer"></div>

<script>
// ===== MAIN USER TASKS =====
let todos = JSON.parse(sessionStorage.getItem('userTodos')) || [];

const todoForm = document.getElementById('todoForm');
const todoInput = document.getElementById('todoInput');
const todoList = document.getElementById('todoList');
const emptyState = document.getElementById('emptyState');
const activeCount = document.getElementById('activeCount');
const completedCount = document.getElementById('completedCount');

todoForm.addEventListener('submit', e => {
    e.preventDefault();
    const text = todoInput.value.trim();
    if (!text) return;

    todos.unshift({id: Date.now().toString(), text, completed: false});
    todoInput.value = '';
    saveAndRender();
});

function toggleTodo(id) {
    todos = todos.map(t => t.id === id ? {...t, completed: !t.completed} : t);
    saveAndRender();
}

function deleteTodo(id) {
    todos = todos.filter(t => t.id !== id);
    saveAndRender();
}

function saveAndRender() {
    sessionStorage.setItem('userTodos', JSON.stringify(todos));
    const completedTaskIds = todos.filter(t => t.completed).map(t => t.id);
    localStorage.setItem('completedTaskIds', JSON.stringify(completedTaskIds));
    render();
}

function render() {
    todoList.innerHTML = todos.map(todo => `
        <div class="todo-item">
            <input type="checkbox" ${todo.completed ? 'checked' : ''}
                onchange="toggleTodo('${todo.id}')">
            <span class="todo-text ${todo.completed ? 'completed' : ''}"
                onclick="toggleTodo('${todo.id}')">
                ${escapeHtml(todo.text)}
            </span>
            <button class="delete-btn" onclick="deleteTodo('${todo.id}')">âœ–</button>
        </div>
    `).join('');

    const active = todos.filter(t => !t.completed).length;
    const completed = todos.filter(t => t.completed).length;
    activeCount.textContent = `${active} active mission${active !== 1 ? 's' : ''}`;
    completedCount.textContent = completed ? `${completed} completed` : '';
    emptyState.style.display = todos.length ? 'none' : 'block';
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// ===== CATEGORY TASKS & STARS =====
let categoryState = JSON.parse(sessionStorage.getItem('categoryState')) || {};
const categoryCheckboxes = document.querySelectorAll('.category-checkbox');

// Floating stars
const starContainer = document.getElementById('starContainer');
const NUM_STARS = 50;
const floatingStars = [];

for (let i = 0; i < NUM_STARS; i++) {
    const star = document.createElement('div');
    star.classList.add('star');
    star.style.width = star.style.height = Math.random() * 3 + 1 + 'px';
    star.style.top = Math.random() * 100 + '%';
    star.style.left = Math.random() * 100 + '%';
    star.style.animation = `twinkle ${Math.random() * 3 + 2}s infinite`;
    starContainer.appendChild(star);
    floatingStars.push(star);
}

// Update glow intensity and size based on completed category tasks
function updateFloatingStarGlow() {
    const completedCount = Object.values(categoryState).filter(Boolean).length;

    floatingStars.forEach(star => {
        // Base size
        let size = 2 + Math.random() * 2;

        // Increase size with completed tasks
        size += completedCount * 6; // bigger growth

        star.style.width = star.style.height = size + 'px';

        // Glow intensity grows sharply
        const intensity = 15 + completedCount * 25; 
        star.style.boxShadow = `
            0 0 ${intensity}px gold,
            0 0 ${intensity * 2}px gold,
            0 0 ${intensity * 3}px #fdd835
        `;
    });
}

// Initialize category checkboxes
categoryCheckboxes.forEach(cb => {
    const starId = cb.dataset.star;
    const starEl = document.getElementById(starId);

    if (categoryState[starId]) {
        cb.checked = true;
        starEl.classList.add('glow');
    }

    cb.addEventListener('change', e => {
        if (cb.checked) {
            starEl.classList.add('glow');
            categoryState[starId] = true;
        } else {
            starEl.classList.remove('glow');
            categoryState[starId] = false;
        }
        sessionStorage.setItem('categoryState', JSON.stringify(categoryState));
        updateFloatingStarGlow();
    });
});

// Update floating stars at start
updateFloatingStarGlow();

window.toggleTodo = toggleTodo;
window.deleteTodo = deleteTodo;

render();
</script>
</body>
</html>
